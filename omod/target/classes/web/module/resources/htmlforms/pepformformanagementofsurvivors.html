<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
  -->
<htmlform>
    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            //Defaults
            jq("#tbl-sti-trx-not-issued").hide();
            jq("#tbl-ecp-not-issued").hide();
            jq("#tbl-date-given-starter-pack").hide();
            jq("#row-starter-pack").hide();
            jq("#tbl-pep-regimen-not-issued").hide();
            jq("#tbl-prc-number").hide();
            jq("#row-pep-negative-result").hide();
            jq("#row-ccc-positive-result").hide();
            jq("#tbl-assault-type-other").hide();
            jq("#tbl-other-violence").hide();


            //Referred by selected
            jq("#sti-trx :input[type=radio]").change(stiTrxNotIssuedSelected);
            jq("#pep-regimen :input[type=radio]").change(pepRegimenNotIssuedSelected);
            jq("#starter-pack-issued :input[type=radio]").change(starterpckIssuedSelected);
            jq("#ecp-issued :input[type=radio]").change(ecpNotIssuedSelected);
            jq("#other-violence :input[type=radio]").change(otherViolenceSelected);
            jq("#hiv-test-result :input[type=radio]").change(hivTestResultSelected);
            jq("#other-assault :input[type=checkbox]").change(otherAssaultSelected);
          });


            var otherViolenceSelected = function () {
            var val = jq(this).val();
            if (val == 5622 ){
                jq("#tbl-other-violence").show();
            }else {
                jq("#tbl-other-violence").hide();
                clearHiddenSections(jq("#tbl-other-violence"));
            }
        };

            var hivTestResultSelected = function () {
            var val = jq(this).val();
            if (val == 664 ){
                jq("#row-pep-negative-result").show();
            }
            else if(val == 703){
                jq("#row-ccc-positive-result").show();
            }
            else {
                jq("#row-pep-negative-result").hide();
                clearHiddenSections(jq("#row-pep-negative-result"));

                jq("#row-ccc-positive-result").hide();
                clearHiddenSections(jq("#row-ccc-positive-result"));
            }
        };

          var otherAssaultSelected= function () {
            var val = jq(this).val();
            if (val == 5622 ){
                jq("#tbl-assault-type-other").show();
            }else {
                jq("#tbl-assault-type-other").hide();
                clearHiddenSections(jq("#tbl-assault-type-other"));
            }
        };



         var stiTrxNotIssuedSelected = function () {
            var val = jq(this).val();
            if (val == 1066 ){
                jq("#tbl-sti-trx-not-issued").show();
            }else {
                jq("#tbl-sti-trx-not-issued").hide();
                clearHiddenSections(jq("#tbl-sti-trx-not-issued"));
            }
        };


         var pepRegimenNotIssuedSelected = function () {
            var val = jq(this).val();
            if (val == 1066 ){
                jq("#tbl-pep-regimen-not-issued").show();
            }
            else if(val == 1065 ) {
                jq("#row-starter-pack").show();
            }
            else{
                 jq("#row-starter-pack").hide();
                 clearHiddenSections(jq("#row-starter-pack"));

                jq("#tbl-pep-regimen-not-issued").hide();
                clearHiddenSections(jq("#tbl-pep-regimen-not-issued"));
            }
        };


        var starterpckIssuedSelected = function () {
            var val = jq(this).val();
            if (val == 1065){
                jq("#tbl-date-given-starter-pack").show();
            }else {
                jq("#tbl-date-given-starter-pack").hide();
                clearHiddenSections(jq("#tbl-date-given-starter-pack"));
            }
        };
          ecpNotIssuedSelected = function () {
            var val = jq(this).val();
            if (val == 1066 ){
                jq("#tbl-ecp-not-issued").show();
            }else {
                jq("#tbl-ecp-not-issued").hide();
                clearHiddenSections(jq("#tbl-ecp-not-issued"));
            }
        };


        //Clear hidden sections
        clearHiddenSections = function(parentObj) {
            parentObj.find('input[type=radio]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=checkbox]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=text]').each(function() {
                jq(this).val("");
            });
            parentObj.find('select').each(function() {
                this.selectedIndex =0;
            });
        }
    </script>
    <ifMode mode="EDIT">
        <script type="text/javascript">
                    $(document).ready(function () {
            //Defaults
            jq("#tbl-sti-trx-not-issued").hide();
            jq("#tbl-ecp-not-issued").hide();
            jq("#tbl-date-given-starter-pack").hide();
            jq("#row-starter-pack").hide();
            jq("#tbl-pep-regimen-not-issued").hide();
            jq("#tbl-prc-number").hide();
            jq("#row-pep-negative-result").hide();
            jq("#row-ccc-positive-result").hide();
            jq("#tbl-assault-type-other").hide();
            jq("#tbl-other-violence").hide();


            //Referred by selected
            jq("#sti-trx :input[type=radio]").change(stiTrxNotIssuedSelected);
            jq("#pep-regimen :input[type=radio]").change(pepRegimenNotIssuedSelected);
            jq("#starter-pack-issued :input[type=radio]").change(starterpckIssuedSelected);
            jq("#ecp-issued :input[type=radio]").change(ecpNotIssuedSelected);
            jq("#other-violence :input[type=radio]").change(otherViolenceSelected);
            jq("#hiv-test-result :input[type=radio]").change(hivTestResultSelected);
            jq("#other-assault :input[type=checkbox]").change(otherAssaultSelected);
          });


            var otherViolenceSelected = function () {
            var val = jq(this).val();
            if (val == 5622 ){
                jq("#tbl-other-violence").show();
            }else {
                jq("#tbl-other-violence").hide();
                clearHiddenSections(jq("#tbl-other-violence"));
            }
        };

            var hivTestResultSelected = function () {
            var val = jq(this).val();
            if (val == 664 ){
                jq("#row-pep-negative-result").show();
            }
            else if(val == 703){
                jq("#row-ccc-positive-result").show();
            }
            else {
                jq("#row-pep-negative-result").hide();
                clearHiddenSections(jq("#row-pep-negative-result"));

                jq("#row-ccc-positive-result").hide();
                clearHiddenSections(jq("#row-ccc-positive-result"));
            }
        };

          var otherAssaultSelected= function () {
            var val = jq(this).val();
            if (val == 5622 ){
                jq("#tbl-assault-type-other").show();
            }else {
                jq("#tbl-assault-type-other").hide();
                clearHiddenSections(jq("#tbl-assault-type-other"));
            }
        };



         var stiTrxNotIssuedSelected = function () {
            var val = jq(this).val();
            if (val == 1066 ){
                jq("#tbl-sti-trx-not-issued").show();
            }else {
                jq("#tbl-sti-trx-not-issued").hide();
                clearHiddenSections(jq("#tbl-sti-trx-not-issued"));
            }
        };


         var pepRegimenNotIssuedSelected = function () {
            var val = jq(this).val();
            if (val == 1066 ){
                jq("#tbl-pep-regimen-not-issued").show();
            }
            else if(val == 1065 ) {
                jq("#row-starter-pack").show();
            }
            else{
                 jq("#row-starter-pack").hide();
                 clearHiddenSections(jq("#row-starter-pack"));

                jq("#tbl-pep-regimen-not-issued").hide();
                clearHiddenSections(jq("#tbl-pep-regimen-not-issued"));
            }
        };

        var starterpckIssuedSelected = function () {
            var val = jq(this).val();
            if (val == 1065){
                jq("#tbl-date-given-starter-pack").show();
            }else {
                jq("#tbl-date-given-starter-pack").hide();
                clearHiddenSections(jq("#tbl-date-given-starter-pack"));
            }
        };
          ecpNotIssuedSelected = function () {
            var val = jq(this).val();
            if (val == 1066 ){
                jq("#tbl-ecp-not-issued").show();
            }else {
                jq("#tbl-ecp-not-issued").hide();
                clearHiddenSections(jq("#tbl-ecp-not-issued"));
            }
        };


        </script>
    </ifMode>
    <style>
        .simple-table {
        border: solid 1px #DDEEEE;
        border-collapse: collapse;
        border-spacing: 0;
        font: normal 13px Arial, sans-serif;
        }

        .simple-table thead th {
        background-color: #DDEFEF;
        border: solid 1px #DDEEEE;
        color: #336B6B;
        padding: 10px;
        text-align: left;
        text-shadow: 1px 1px 1px #fff;
        }

        .simple-table td {
        border: solid 1px #DDEEEE;
        color: #333;
        padding: 10px;
        text-shadow: 1px 1px 1px #fff;
        }
    </style>

    <div class="ke-form-header">
        <table width="100%">
            <tr>
                <td>Encounter Date: <encounterDate id="encounter-date" showTime="true" /></td>
                <td>Encounter provider: <encounterProvider default="currentUser" role="Provider"/></td>
                <td>Location: <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" type="autocomplete" /></td>
            </tr>
        </table>
    </div>
    <div class="ke-form-content">
        <fieldset class="adherence-screening">
            <table class="simple-table" id="Checklist-tbl1">
                <tr>
                    <td><b>Reporting Date and Time</b></td>
                    <td><obs required="true" conceptId="166848" size="30" /></td>
                    <td>PRC Number <strong>(format:PRC#-10-2022-00001 )</strong></td>
                    <td><obs required="true" id="prc-number" conceptId="1646" size="30"/></td>
                </tr>
                <tr>
                    <table class="simple-table" >
                        <tr>
                            <th></th>
                            <th>Current</th>
                            <th>Recent</th>
                        </tr>
                        <tr>
                            <td>Weight</td>
                            <td>
                                <obs id="weight" conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true"/>
                                kg
                            </td>
                            <td>
                                <recentObs conceptId="5089AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                        </tr>
                        <tr>
                            <td>Height</td>
                            <td>
                                <obs id="height" conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" required="true"/>
                                cm
                            </td>
                            <td>
                                <recentObs conceptId="5090AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                            </td>
                        </tr>
                        <includeIf velocityTest="$patient.gender == 'F' ">
                            <tr>
                                <td>LMP</td>
                                <td>
                                    <obs id="lmp-date" conceptId="1427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                </td>
                                <td>
                                    <recentObs conceptId="1427AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"/>
                                </td>
                            </tr>
                        </includeIf>
                    </table>
                </tr>
            </table>
        </fieldset>
        <!--SEXUAL VIOLENCE-->
        <fieldset id="Assesment-tab3">
            <legend>
                <strong>Violence Detail</strong>
            </legend>
            <table class="simple-table" id="adherence-3">
                <tr>
                    <td>Type of Violence</td>
                    <td>
                        <obs required="true" conceptId="165205"
                             answerLabels="Rape,Defilement,Other"
                             answerConceptIds="127910,145691,5622"
                             style="radio"
                             id="other-violence"/><br/>
                    </td>
                    <td>
                        <table class="simple-table" id="tbl-other-violence">
                            <tr>
                                <td> Specify other violence</td>
                                <td><obs conceptId="165138" style="textarea" rows="2"  cols="60" /></td>
                            </tr>
                        </table>
                    </td>

                    <td>Type of Assault</td>
                    <td>
                        <obs conceptId="123160" answerLabel="Oral" answerConceptId="166060" style="checkbox"/> <br/>
                        <obs conceptId="123160" answerLabel="Vaginal" answerConceptId="123385" style="checkbox"/><br/>
                        <obs conceptId="123160" answerLabel="Anal" answerConceptId="148895" style="checkbox"/><br/>
                        <obs conceptId="123160" answerLabel="Other (specify)" answerConceptId="5622" id="other-assault" style="checkbox"/>
                    </td>
                    <td>
                        <table class="simple-table" id="tbl-assault-type-other">
                            <tr>
                                <td>Specify other Assault</td>
                                <td><obs conceptId="164879" style="textarea" rows="2" cols="60"/></td>
                            </tr>
                        </table>
                    </td>

                    <td><b>Date of Incidence</b></td>
                    <td><obs conceptId="165349" size="50" /></td>
                </tr>
            </table>
        </fieldset>
        <!--PERPETRATORS DETAILS-->
        <fieldset id="Assesment-tab4">
            <legend>
                <strong>Perpetrators Details</strong>
            </legend>
            <table class="simple-table" id="adherence-1">
                <tr>
                    <td><b>Identity of perpetrator (if known)</b></td>
                    <td><obs conceptId="165230" rows="2" cols="50" /></td>
                    <td><b>Relation of survivor to perpetrator</b></td>
                    <td>
                        <obs conceptId="1530"
                                  answerLabels="Grandchild,Partner or Spouse,Grandparent,Parent,Child,Other family members,Sibling,Unknown,None"
                                  answerConceptIds="1529,5617,973,1527,1528,5620,972,1067,1107"
                                  style="radio"
                                  id="relation" /><br/>
                    </td>
                    </tr>
                <tr>
                    <td><b>Compulsory HIV test on perpetrator</b></td>
                    <td><obs id="hiv-test"  conceptId="164848" answerLabels="Done,Not Done" answerConceptIds="1065,1066" style="radio" /></td>
                    <td>Result for the compulsory HIV test</td>
                    <td><obs  conceptId="159427" answerLabels="Negative,Positive" answerConceptIds="664,703" style="radio" /></td>
                    <td>Perpetrator's file number</td>
                    <td><obs conceptId="1639" size="50" /></td>
                </tr>
            </table>
        </fieldset>
        <!--Physical Examination-->
        <fieldset id="Assesment-tab5">
            <legend>
                <strong>Physical Examination:</strong>
            </legend>
            <table class="simple-table" id="adherence-5">
                <p align="left"><strong>Specimen (presence for medico-legal purposes)</strong></p>
                <tr>
                    <td><b>State of the Patient</b></td>
                    <td><obs conceptId="163042" rows="3" cols="60" required="true" /></td>
                    <td><b>State of Clothing</b></td>
                    <td><obs conceptId="163045" rows="3" cols="60" required="true" /></td>
                    <td><b>Examination of the Genitalia</b></td>
                    <td><obs conceptId="160971" rows="3" cols="60" required="true" /></td>
                    <td><b>Other injuries of the patient</b></td>
                    <td><obs conceptId="165092" rows="3" cols="60" required="true" /></td>
                </tr>
            </table>
            <table class="simple-table">
                        <tr>
                            <td>1. High Vaginal/Anal Swab (Microscopy and Gram Staining)</td>
                            <td><obs  conceptId="166141" answerLabels="Non-Reactive,Reactive" answerConceptIds="664,703" style="radio" /></td>
                            <td><p><b>Blood</b></p>
                                <table class="simple-table">
                                    <tr>
                                        <td>a) RPR/VDRL</td>
                                        <td><obs  conceptId="299" answerLabels="Non-Reactive,Reactive" answerConceptIds="1229,1228" style="radio" /></td>
                                        <td>b) HIV Test result (Offer Pre-test counselling)</td>
                                        <td><obs id="hiv-test-result" conceptId="163760" answerLabels="Non-Reactive,Reactive" answerConceptIds="664,703" style="radio" /></td>
                                    </tr>
                                    <tr id="row-pep-negative-result">
                                        <td><b>c) Other services offered;</b><p>Given PEP if HIV test results is Non-Reactive</p></td>
                                        <td><obs  conceptId="165171" answerLabel="Yes" answerConceptId="1065" style="checkbox" /></td>
                                    </tr>
                                    <tr id="row-ccc-positive-result">
                                        <td>Refer to PSC if Reactive</td>
                                        <td><obs  conceptId="165270" answerLabel="Yes" answerConceptId="1065" style="checkbox" /> </td>
                                    </tr>
                                </table>
                            </td>
                            <td>3.PDT</td>
                            <td><obs  conceptId="167229" answerLabels="Negative,Positive" answerConceptIds="703,664" style="radio" /></td>
                        </tr>
              </table>
        </fieldset>
        <!--P-->
        <fieldset id="Assesment-tab6">
            <legend>
                <strong>Contraception and Prophylaxis</strong>
            </legend>
            <table class="simple-table" id="adherence-6">
                <includeIf velocityTest="$patient.gender == 'F' ">
                <tr>
                    <td><b>Emergency Contraception Issued</b></td>
                    <td><obs  id="ecp-issued"  conceptId="165167" answerLabels="Issued,Not Issued" answerConceptIds="1065,1066" style="radio" /></td>
                    <td>
                        <table class="simple-table" id="tbl-ecp-not-issued">
                            <tr>
                                <td><b>Specify why not issued</b></td>
                                <td> <obs conceptId="160138" style="textarea" rows="2" cols="60" /></td>
                            </tr>
                        </table>
                    </td>
               </tr>
               </includeIf>
                <tr>
                    <td><b>STI Prophylaxis and Treatment</b></td>
                    <td>
                        <obs required="true" id="sti-trx" conceptId="165200" answerLabels="STI Prophylaxis,
                                                               STI Treatment (Use drugs orders for prescription),
                                                               Not Issued"
                                                 answerConceptIds="166536,1065,1066" style="radio" /><br/>
                    </td>
                    <td>
                        <table class="simple-table" id="tbl-sti-trx-not-issued">
                            <tr>
                                <td>Specify why not issued?</td>
                                <td><obs conceptId="160953" style="textarea" rows="2" cols="60"/></td>
                            </tr>
                        </table>
                    </td>

                </tr>
                <tr>
                    <td><b>PEP Regimen</b></td>
                    <td>
                        <obs required="true" id="pep-regimen" conceptId="164845" answerLabels="Issued,Not Issued" answerConceptIds="1065,1066" style="radio" />
                    </td>
                    <td>
                        <table class="simple-table"  id="tbl-pep-regimen-not-issued">
                            <tr>
                                <td>Specify why not issued</td>
                                <td><obs conceptId="160954" style="textarea" rows="2"  cols="60"/></td>
                            </tr>
                        </table>
                    </td>
                </tr>
                <tr id="row-starter-pack">
                    <td><b>Starter Pack given</b></td>
                    <td>
                        <obs id="starter-pack-issued" conceptId="1263" answerLabels="Yes,No" answerConceptIds="1065,1066" style="radio" /><br></br>
                    </td>
                    <td>
                        <table class="simple-table" id="tbl-date-given-starter-pack">
                            <tr>
                                <td><b>Date given PEP</b></td>
                                <td><obs conceptId="166865" size="50" /></td>
                            </tr>
                        </table>
                    </td>
                </tr>
            </table>
        </fieldset>
        <!-- Baseline -->
        <fieldset id="Assesment-tab7">
            <legend>
                <strong>Baseline Tests and Appointment Details</strong>
            </legend>
            <table class="simple-table" id="adherence-7">
                <tr>
                    <td><b>1. HBsAG</b></td>
                    <td><obs  conceptId="161472" answerLabels="Non Reactive,Reactive" answerConceptIds="664,703" style="radio" /></td>
                </tr>
                <tr>
                    <td><b>2. LFTs: ALT</b></td>
                    <td><obs conceptId="654" size="30" /></td>
                </tr>
                <tr>
                    <td><b>3. RFTs: Creatinine</b></td>
                    <td><obs conceptId="790" size="30" /></td>
                </tr>
                <tr>
                    <td><b>4. Other test (Specify)</b></td>
                    <td><obs conceptId="160987" style="textarea" rows="2" cols="60" /></td>
                </tr>
                <tr>
                    <td><b>TCA Date</b></td>
                    <td><obs conceptId="160753" required="" size="50" allowFutureDates="true" /></td>
                </tr>

            </table>
        </fieldset>
    </div>
    <div class="ke-form-footer">
        <submit />
    </div>

</htmlform>