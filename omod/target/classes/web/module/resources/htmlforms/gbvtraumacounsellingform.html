<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
  -->
<htmlform>
    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
    <script type="text/javascript">
       $(document).ready(function () {
            //Defaults
            jq("#tbl-other-referral-source").hide();

            //Referred by selected
            jq("#referred-from :input[type=radio]").change(otherReferralSelected);
          });

        var otherReferralSelected = function () {
            var val = jq(this).val();
            if (val == 5622 ){
                jq("#tbl-other-referral-source").show();
            }else {
                jq("#tbl-other-referral-source").hide();
                clearHiddenSections(jq("#tbl-other-referral-source"));
            }
        };


        //Before Submit
        beforeSubmit.push(function() {
            var referredBy = getValue('referral-by.value');
            var clientType = getValue('client-type.value');
            var otherReferred = jq('#other-referral input[type=text]').val();
            var infoSource = getValue('information-source.value');
            var otherInfoSource = jq('#other-information-source input[type=text]').val();
            var county = getField('county.value').val();
            if(referredBy == ""){
                getField('referral-by.error').html('Please specify referral source').show();
                return false;
            }else {
                getField('referral-by.error').html('Please specify referral source').hide();
            }


            return true;
        });

        //Clear hidden sections
        clearHiddenSections = function(parentObj) {
            parentObj.find('input[type=radio]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=checkbox]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=text]').each(function() {
                jq(this).val("");
            });
            parentObj.find('select').each(function() {
                this.selectedIndex =0;
            });
        }
    </script>
    <style>
        .simple-table {
        border: solid 1px #DDEEEE;
        border-collapse: collapse;
        border-spacing: 0;
        font: normal 13px Arial, sans-serif;
        }

        .simple-table thead th {
        background-color: #DDEFEF;
        border: solid 1px #DDEEEE;
        color: #336B6B;
        padding: 10px;
        text-align: left;
        text-shadow: 1px 1px 1px #fff;
        }

        .simple-table td {
        border: solid 1px #DDEEEE;
        color: #333;
        padding: 10px;
        text-shadow: 1px 1px 1px #fff;
        }
    </style>

    <div class="ke-form-header">
        <table width="100%">
            <tr>
                <td>Encounter Date: <encounterDate id="encounter-date" showTime="true" /></td>
                <td>Encounter provider: <encounterProvider default="currentUser" role="Provider"/></td>
                <td>Location: <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" type="autocomplete" /></td>
            </tr>
        </table>
    </div>

    <div class="ke-form-content">
        <fieldset class="adherence-screening">
            <legend>
                <strong>Visit Details</strong>
            </legend>
            <table class="simple-table" id="Checklist-tbl1">
                <tr>
                    <td>OCN Number</td>
                    <td><obs conceptId="165416" size="30"/></td>
                    <td>Type of Exposure</td>
                    <td><obs  conceptId="165248" style="textarea" size="30" /></td>
                </tr>
                <tr>
                    <td>Visit No</td>
                    <td><obs conceptId="162086" size="25"/></td>
                    <td>Presenting Issues</td>
                    <td><obs conceptId="165138" size="50"  style="textarea"/></td>
                    <td>HIV Test Results</td>
                    <td><obs  conceptId="165171" answerLabels="Yes,No" answerConceptIds="1065,1066" style="radio" /></td>
                    <td>TCA</td>
                    <td><obs conceptId="162549" allowFutureDates="true" size="50" /></td>
                </tr>
            </table>
        </fieldset>
    </div>
    <div class="ke-form-footer">
        <submit />
    </div>

</htmlform>